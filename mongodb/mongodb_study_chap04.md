
# 4장 주요 내용.
### 1. 도큐먼트 지향 데이터
 - 스키마 설계
 - 전자상거래 데이터 모델
 - 데이터베이스, 컬렉션, 도큐먼트의 실제적 세부사항들.
 
### 2. 전자상거래 스키마 설계를 살펴보며 이 과장에서 RDBMS의 스키마와 어떻게 다른지 설명.
### 3. MongoDB에서 일대다, 다대다와 같이 개체 간의 관계가 어떻게 표현되는지 확인.
### 4. 지금까지 다뤘던 것보다는 훨씬 더 자세하게 데이터베이스, 컬렉션 도큐먼트에 대해 논의.


## 4.1. 스키마 설계 원리.
### RDBMS 에서는 정규화된 데이터 모델을 권장
- 이것은 일반적인 질의성(query ability)을 보장하고 무결성을 해칠수도 있는 데이터 업데이트를 피하는데 도움이 됨.
- 패턴이 이미 확인되어 있어서 개발자들은 RDBMS 에서 일대다, 다대다 관계를 생성하는 방법을 이미 알고 있음.
- 하지만 애플리케이션 기능과 성능은 스키마 설계에서 궁극적으로 중요한 요소이므로 모든 규칙은 예외를 가지게 됨.

### 기존 RDBMS를 사용했던 사람이면 MongoDB에 스키마 설계 규칙이 없는것에 당황.
- 일반적으로 받아들여질 만한 선례가 MongoDB에서도 나타나고 있지만, 솔직히 말해서 주어진 데이터를 모델링할 때 좋은 방법이 한가지만 있는게 아닐때가 종종 있다.
- 이론에 따라 스키마를 설계해야 하지만, 실제에서는 이론을 융통성 있게 적용한다라는 전제를 바탕으로 한다.

### 어떠한 데이터베이스 시스템으로 모델링을 하더라도 제기할 수 있는 질문은 다음과 같음.
- 애플리케이션의 액세스 패턴은 무엇인가?
	- 애플리케이션의 요구사항이 무엇인지 정확하게 파악할 필요가 있다.
		- MongoDB가 모든 애플리케이션에 적합한 것은 아님.
		- 애플리케이션 액세스 패턴을 이해하는 것은 스키마 설계에서 가장 중요한 부분.
	- 데이터모델을 결정하는데 도움을 얻기 위해서는 애플리케이션에 관해서 여러가지 질문을 해야함.
		- 읽기/쓰기 비율은 어떻게 되는가?
		- 쿼리는 키를 찾는 정도로 쉬운가? 아니면 더 복잡한가?
		- 집계는 필요한가?
		- 데이터는 얼마나 저장되는가?
- 데이터베이스에는 어떤 기능이 있는가?
	- 데이터의 기본 단위가 있으면 그것을 조작하는 법을 배워야 함.
	- 간단한 키-값 저장 시스템이 하나의 키에 대해셔만 값을 가져올 수 있는 반면에 RDBMS 는 애드혹 쿼리와 조인이라는 특징이 있다.
	- MongoDB 또한 애드혹 쿼리를 허용, 조인은 지원하지 않음.
	- MongoDB는 기존 방식의 트랜잭션을 지원하지 않지만, 복잡한 도큐먼트의 내부 구조에 대해 수행할 수 있는 원자적인 업데이트를 다양하게 지원.
- 좋은 고유 식별자(unique id)와 프라이머리 키를 무엇으로 만드는가?
	- 예외가 있긴 하지만, 데이터베이스에 관계없이 많은 스키마들이 고유한 키를 갖는다.
	- 이러한 키를 고르는 것은 데이터를 접근하는 방식과 저장하는 방식에서 큰 차이를 만들어 낼 수 있다.
		- 예를 들어, 사용자들의 컬렉션을 설계하고 있다면 임의의 값, 법적인 성명, 사용자 이름, 또는 사회보장 번호를 프라이머리 키로 사용해야 하나?
		- 모든 사용자들에게 적용할 만한 것은 아님.
	- MongoDB 에서 primary key를 선택하는 것은 어떤 값이 _id 필드에 채워질 것인지 고르는 것을 뜻함.
		- 자동으로 생성되는 객체 id는 기본 설정으로 나쁘지 않지만, 모든 경우에 이상적인 것은 아니다.
		- 여러 장비에 데이터를 샤딩하는 경우라면 이는 특히 중요한데, 특정 행이 저장될 곳을 결정하기 때문.


## 4.2. 전자상거래 데이터 모델 설계









아직 정리 못함